---
title: "psycopg2でスキーマを指定してCOPYする方法"
emoji: "🍣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["PostgreSQL", "Psycopg2", "Python"]
published: false
---

# 概要
psycopg2の2.9以降でスキーマを指定した`copy_from`が出来なくなっていた。
COPY前にスキーマ指定して解決した。

# 流れ
既存のコードが動かなくなる事象に遭遇。
```python
cursor.copy_from(file=f, table="schema.table_name", sep=",")
```
githubのissueに類似の報告があり、SQLインジェクション対策で2.9以降にできなくなったのこと。
https://github.com/psycopg/psycopg2/issues/1294

# 別解
```python
cursor.copy_expert("COPY schema.table FROM STDIN")
```
